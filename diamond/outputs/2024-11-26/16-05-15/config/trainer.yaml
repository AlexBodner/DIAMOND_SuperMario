wandb:
  mode: disabled
  project: null
  entity: null
  name: null
  group: null
  tags: null
  notes: null
initialization:
  path_to_ckpt: null
  load_denoiser: true
  load_rew_end_model: true
  load_actor_critic: true
common:
  devices: all
  seed: null
  resume: false
checkpointing:
  save_agent_every: 5
  num_to_keep: 11
collection:
  train:
    num_envs: 1
    epsilon: 0.01
    num_steps_total: 100000
    first_epoch:
      min: 5000
      max: 10000
      threshold_rew: 10
    steps_per_epoch: 100
  test:
    num_envs: 1
    num_episodes: 4
    epsilon: 0.0
    num_final_episodes: 100
static_dataset:
  path: ${env.path_data_low_res}
  ignore_sample_weights: true
training:
  should: true
  num_final_epochs: 1500
  cache_in_ram: false
  num_workers_data_loaders: 4
  model_free: false
  compile_wm: false
evaluation:
  should: true
  every: 20
denoiser:
  training:
    num_autoregressive_steps: 4
    start_after_epochs: 0
    steps_first_epoch: 100
    steps_per_epoch: 100
    sample_weights: null
    batch_size: 14
    grad_acc_steps: 1
    lr_warmup_steps: 100
    max_grad_norm: 10.0
  optimizer:
    lr: 0.0001
    weight_decay: 0.01
    eps: 1.0e-08
  sigma_distribution:
    _target_: models.diffusion.SigmaDistributionConfig
    loc: -1.2
    scale: 1.2
    sigma_min: 0.002
    sigma_max: 20
upsampler:
  training:
    num_autoregressive_steps: 1
    start_after_epochs: 0
    steps_first_epoch: 400
    steps_per_epoch: 400
    sample_weights: null
    batch_size: 14
    grad_acc_steps: 1
    lr_warmup_steps: 100
    max_grad_norm: 10.0
  optimizer: ${denoiser.optimizer}
  sigma_distribution: ${denoiser.sigma_distribution}
env:
  train:
    id: csgo
    size:
    - 240
    - 256
  num_actions: 7
  path_data_low_res: /mnt/c/Users/alex_/Documents/Udesa/3ero/Vision/TP Final Vision/AI-MarioKart64/diamond/processed/low_res
  path_data_full_res: /mnt/c/Users/alex_/Documents/Udesa/3ero/Vision/TP Final Vision/AI-MarioKart64/diamond/processed/full_res
  keymap: csgo
agent:
  _target_: agent.AgentConfig
  denoiser:
    _target_: models.diffusion.DenoiserConfig
    sigma_data: 0.5
    noise_previous_obs: true
    upsampling_factor: null
    sigma_offset_noise: 0.1
    inner_model:
      _target_: models.diffusion.InnerModelConfig
      img_channels: 3
      num_steps_conditioning: 4
      cond_channels: 2048
      depths:
      - 2
      - 2
      - 2
      - 2
      channels:
      - 64
      - 64
      - 64
      - 64
      attn_depths:
      - 0
      - 0
      - 0
      - 0
  upsampler:
    _target_: models.diffusion.DenoiserConfig
    sigma_data: 0.5
    sigma_offset_noise: 0.1
    noise_previous_obs: false
    upsampling_factor: 6
    inner_model:
      _target_: models.diffusion.InnerModelConfig
      img_channels: 3
      num_steps_conditioning: 1
      cond_channels: 2048
      depths:
      - 2
      - 2
      - 2
      - 2
      channels:
      - 64
      - 64
      - 128
      - 256
      attn_depths:
      - 0
      - 0
      - 0
      - 1
  rew_end_model: null
  actor_critic: null
world_model_env:
  _target_: envs.WorldModelEnvConfig
  horizon: 1000
  num_batches_to_preload: 256
  diffusion_sampler_next_obs:
    _target_: models.diffusion.DiffusionSamplerConfig
    num_steps_denoising: 1
    sigma_min: 0.002
    sigma_max: 5.0
    rho: 7
    order: 1
    s_churn: 0.0
    s_tmin: 0.0
    s_tmax: ${eval:'float("inf")'}
    s_noise: 1.0
    s_cond: 0.005
  diffusion_sampler_upsampling:
    _target_: models.diffusion.DiffusionSamplerConfig
    num_steps_denoising: 1
    sigma_min: 1
    sigma_max: 5.0
    rho: 7
    order: 2
    s_churn: 10.0
    s_tmin: 1
    s_tmax: 5
    s_noise: 0.9
    s_cond: 0
